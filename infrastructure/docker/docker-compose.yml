version: "3.4"
services:
    tunnel:
        image: ngrok/ngrok:latest
        restart: always
        networks:
            - services_network

    db:
        image: postgres:17.0
        restart: always
        networks:
            - services_network

    redis:
        image: redis:6.2-alpine
        restart: always
        volumes:
            - redis_cache:/data
        networks:
            - services_network

    backend:
        build:
            context: ../../services/Backend
            dockerfile: Dockerfile
        networks:
            - services_network
        depends_on:
            - redis
            - db

    frontend:
        build:
            context: ../../services/Frontend
            dockerfile: Dockerfile
        networks:
            - services_network

    gateway:
        build:
            context: ../../services/Gateway
            dockerfile: Dockerfile
        networks:
            - services_network

networks:
    services_network:
        external: true

volumes:
    postgres:
        external: false
    redis_cache:
        external: false
