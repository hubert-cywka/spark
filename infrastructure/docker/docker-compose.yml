version: "3.4"
services:
    db:
        image: postgres
        restart: always
        healthcheck:
            test: [ "CMD-SHELL", "pg_isready -d $${POSTGRES_DB} -U $${POSTGRES_USER}" ]
            interval: 1s
            timeout: 10s
            retries: 3

    proxy-service:
        build:
            context: services/Proxy
            dockerfile: Dockerfile
        networks:
            - services_network

    ui-service:
        build:
            context: services/UI
            dockerfile: Dockerfile
        networks:
            - services_network

    access-service:
        build:
            context: services/Access
            dockerfile: Dockerfile
        networks:
            - services_network

networks:
    services_network:
        external: true

volumes:
    postgres:
        external: false

    rabbitmq:
        external: false

    rabbitmq-logs:
        external: false
